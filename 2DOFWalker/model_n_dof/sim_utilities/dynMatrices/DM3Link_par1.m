%Dynamic matrices for a 3-link walker.
%Robot Parameters: 

%Number of links: 3
%Length of links: 1  1  1  
%Position of CoM: 0.5  0.5  0.5  
%Mass of links: 5  5  5  
%Inertia of links: 0.5  0.5  0.5  
%Gravity: 9.81

D = [ 
15*cos(q(2)) + 5*cos(q(3)) + 5*cos(q(2) + q(3)) + 81/4, (15*cos(q(2)))/2 + 5*cos(q(3)) + (5*cos(q(2) + q(3)))/2 + 17/2, (5*cos(q(3)))/2 + (5*cos(q(2) + q(3)))/2 + 7/4, - (25*cos(q(1)))/2 - (5*cos(q(1) + q(2) + q(3)))/2 - (15*cos(q(1) + q(2)))/2, (25*sin(q(1)))/2 + (5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2;
(15*cos(q(2)))/2 + 5*cos(q(3)) + (5*cos(q(2) + q(3)))/2 + 17/2, 5*cos(q(3)) + 17/2, (5*cos(q(3)))/2 + 7/4, - (5*cos(q(1) + q(2) + q(3)))/2 - (15*cos(q(1) + q(2)))/2, (5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2;
(5*cos(q(3)))/2 + (5*cos(q(2) + q(3)))/2 + 7/4, (5*cos(q(3)))/2 + 7/4, 7/4, -(5*cos(q(1) + q(2) + q(3)))/2, (5*sin(q(1) + q(2) + q(3)))/2;
- (25*cos(q(1)))/2 - (5*cos(q(1) + q(2) + q(3)))/2 - (15*cos(q(1) + q(2)))/2, - (5*cos(q(1) + q(2) + q(3)))/2 - (15*cos(q(1) + q(2)))/2, -(5*cos(q(1) + q(2) + q(3)))/2, 15, 0;
(25*sin(q(1)))/2 + (5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2, (5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2, (5*sin(q(1) + q(2) + q(3)))/2, 0, 15;
];

C = [ 
- q_dot(3)*((5*sin(q(3)))/2 + (5*sin(q(2) + q(3)))/2) - q_dot(2)*((15*sin(q(2)))/2 + (5*sin(q(2) + q(3)))/2), - q_dot(3)*((5*sin(q(3)))/2 + (5*sin(q(2) + q(3)))/2) - q_dot(1)*((15*sin(q(2)))/2 + (5*sin(q(2) + q(3)))/2) - q_dot(2)*((15*sin(q(2)))/2 + (5*sin(q(2) + q(3)))/2), -(5*(sin(q(3)) + sin(q(2) + q(3)))*(q_dot(1) + q_dot(2) + q_dot(3)))/2, 0, 0;
q_dot(1)*((15*sin(q(2)))/2 + (5*sin(q(2) + q(3)))/2) - (5*sin(q(3))*q_dot(3))/2, -(5*sin(q(3))*q_dot(3))/2, -(5*sin(q(3))*(q_dot(1) + q_dot(2) + q_dot(3)))/2, 0, 0;
q_dot(1)*((5*sin(q(3)))/2 + (5*sin(q(2) + q(3)))/2) + (5*sin(q(3))*q_dot(2))/2, (5*sin(q(3))*(q_dot(1) + q_dot(2)))/2, 0, 0, 0;
q_dot(1)*((25*sin(q(1)))/2 + (5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2) + q_dot(2)*((5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2) + (5*sin(q(1) + q(2) + q(3))*q_dot(3))/2, q_dot(1)*((5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2) + q_dot(2)*((5*sin(q(1) + q(2) + q(3)))/2 + (15*sin(q(1) + q(2)))/2) + (5*sin(q(1) + q(2) + q(3))*q_dot(3))/2, (5*sin(q(1) + q(2) + q(3))*(q_dot(1) + q_dot(2) + q_dot(3)))/2, 0, 0;
q_dot(1)*((25*cos(q(1)))/2 + (5*cos(q(1) + q(2) + q(3)))/2 + (15*cos(q(1) + q(2)))/2) + q_dot(2)*((5*cos(q(1) + q(2) + q(3)))/2 + (15*cos(q(1) + q(2)))/2) + (5*cos(q(1) + q(2) + q(3))*q_dot(3))/2, q_dot(1)*((5*cos(q(1) + q(2) + q(3)))/2 + (15*cos(q(1) + q(2)))/2) + q_dot(2)*((5*cos(q(1) + q(2) + q(3)))/2 + (15*cos(q(1) + q(2)))/2) + (5*cos(q(1) + q(2) + q(3))*q_dot(3))/2, (5*cos(q(1) + q(2) + q(3))*(q_dot(1) + q_dot(2) + q_dot(3)))/2, 0, 0;
];

G = [ 
- (981*sin(q(1)))/8 - (981*sin(q(1) + q(2) + q(3)))/40 - (2943*sin(q(1) + q(2)))/40;
- (981*sin(q(1) + q(2) + q(3)))/40 - (2943*sin(q(1) + q(2)))/40;
-(981*sin(q(1) + q(2) + q(3)))/40;
0;
2943/20;
];

E2 = [ 
cos(q(1)) + cos(q(1) + q(2)), cos(q(1) + q(2)), 0, 1, 0;
- sin(q(1)) - sin(q(1) + q(2)), -sin(q(1) + q(2)), 0, 0, 1;
];

