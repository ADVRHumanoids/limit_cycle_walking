% link_length = [1 1 0.5];
% com_position = [0.8 0.8 0.5/2];
% m = [0.3 0.3 1]; 
% I = [0.03 0.03 0.1];
% g = 9.81;


D = [                  cos(q(2) - q(3))/2 + (12*cos(q(2)))/25 + 3813/2000, cos(q(2) - q(3))/4 + (6*cos(q(2)))/25 + 611/500, cos(q(2) - q(3))/4 + 13/80, - (31*cos(q(1) + q(2)))/25 - cos(q(1) + q(3))/4 - (27*cos(q(1)))/50, (31*sin(q(1) + q(2)))/25 + sin(q(1) + q(3))/4 + (27*sin(q(1)))/50;
                          cos(q(2) - q(3))/4 + (6*cos(q(2)))/25 + 611/500,                                         611/500,         cos(q(2) - q(3))/4,                                           -(31*cos(q(1) + q(2)))/25,                                          (31*sin(q(1) + q(2)))/25;
                                               cos(q(2) - q(3))/4 + 13/80,                              cos(q(2) - q(3))/4,                      13/80,                                                 -cos(q(1) + q(3))/4,                                                sin(q(1) + q(3))/4;
      - (31*cos(q(1) + q(2)))/25 - cos(q(1) + q(3))/4 - (27*cos(q(1)))/50,                       -(31*cos(q(1) + q(2)))/25,        -cos(q(1) + q(3))/4,                                                                 8/5,                                                                 0;
        (31*sin(q(1) + q(2)))/25 + sin(q(1) + q(3))/4 + (27*sin(q(1)))/50,                        (31*sin(q(1) + q(2)))/25,         sin(q(1) + q(3))/4,                                                                   0,                                                               8/5];
    
    
    
C = [                                                        (sin(q(2) - q(3))*q_dot(3))/4 - (sin(q(2) - q(3))*q_dot(2))/4 - (6*q_dot(2)*sin(q(2)))/25, -((25*sin(q(2) - q(3)) + 24*sin(q(2)))*(q_dot(1) + q_dot(2)))/100, (sin(q(2) - q(3))*(q_dot(1) + q_dot(3)))/4, 0, 0;
                                                             (6*q_dot(1)*sin(q(2)))/25 + (sin(q(2) - q(3))*q_dot(1))/4 + (sin(q(2) - q(3))*q_dot(3))/4,                                                                 0, (sin(q(2) - q(3))*(q_dot(1) + q_dot(3)))/4, 0, 0;
                                                                                                           -(sin(q(2) - q(3))*(q_dot(1) + q_dot(2)))/4,                       -(sin(q(2) - q(3))*(q_dot(1) + q_dot(2)))/4,                                          0, 0, 0;
      (31*q_dot(2)*sin(q(1) + q(2)))/25 + (q_dot(3)*sin(q(1) + q(3)))/4 + q_dot(1)*((31*sin(q(1) + q(2)))/25 + sin(q(1) + q(3))/4 + (27*sin(q(1)))/50),                    (31*sin(q(1) + q(2))*(q_dot(1) + q_dot(2)))/25, (sin(q(1) + q(3))*(q_dot(1) + q_dot(3)))/4, 0, 0;
      q_dot(1)*((31*cos(q(1) + q(2)))/25 + cos(q(1) + q(3))/4 + (27*cos(q(1)))/50) + (31*q_dot(2)*cos(q(1) + q(2)))/25 + (q_dot(3)*cos(q(1) + q(3)))/4,                    (31*cos(q(1) + q(2))*(q_dot(1) + q_dot(2)))/25, (cos(q(1) + q(3))*(q_dot(1) + q_dot(3)))/4, 0, 0];
  
  
G =  [ - (2943*sin(q(1) + q(2)))/1250 - (981*sin(q(1) + q(3)))/400 - (75537*sin(q(1)))/5000;
                                                              -(2943*sin(q(1) + q(2)))/1250;
                                                                -(981*sin(q(1) + q(3)))/400;
                                                                                          0;
                                                                                   1962/125];
 
 