function [D,C,G] = calcDynMatrices(q,q_dot)

if length(q) == 6
D = [            cos(q(2) + q(3) + q(4)) + 3*cos(q(2) + q(3)) + cos(q(3) + q(4)) + 5*cos(q(2)) + 3*cos(q(3)) + cos(q(4)) + 1833/250, cos(q(2) + q(3) + q(4))/2 + (3*cos(q(2) + q(3)))/2 + cos(q(3) + q(4)) + (5*cos(q(2)))/2 + 3*cos(q(3)) + cos(q(4)) + 3999/1000, cos(q(2) + q(3) + q(4))/2 + (3*cos(q(2) + q(3)))/2 + cos(q(3) + q(4))/2 + (3*cos(q(3)))/2 + cos(q(4)) + 833/500, cos(q(2) + q(3) + q(4))/2 + cos(q(3) + q(4))/2 + cos(q(4))/2 + 333/1000, - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2 - (5*cos(q(1) + q(2)))/2 - (7*cos(q(1)))/2, (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2 + (7*sin(q(1)))/2;
      cos(q(2) + q(3) + q(4))/2 + (3*cos(q(2) + q(3)))/2 + cos(q(3) + q(4)) + (5*cos(q(2)))/2 + 3*cos(q(3)) + cos(q(4)) + 3999/1000,                                                                        cos(q(3) + q(4)) + 3*cos(q(3)) + cos(q(4)) + 3999/1000,                                                      cos(q(3) + q(4))/2 + (3*cos(q(3)))/2 + cos(q(4)) + 833/500,                             cos(q(3) + q(4))/2 + cos(q(4))/2 + 333/1000,                   - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2 - (5*cos(q(1) + q(2)))/2,                   (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2;
                    cos(q(2) + q(3) + q(4))/2 + (3*cos(q(2) + q(3)))/2 + cos(q(3) + q(4))/2 + (3*cos(q(3)))/2 + cos(q(4)) + 833/500,                                                                    cos(q(3) + q(4))/2 + (3*cos(q(3)))/2 + cos(q(4)) + 833/500,                                                                                             cos(q(4)) + 833/500,                                                  cos(q(4))/2 + 333/1000,                                            - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2,                                            (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2;
                                                            cos(q(2) + q(3) + q(4))/2 + cos(q(3) + q(4))/2 + cos(q(4))/2 + 333/1000,                                                                                   cos(q(3) + q(4))/2 + cos(q(4))/2 + 333/1000,                                                                                          cos(q(4))/2 + 333/1000,                                                                333/1000,                                                                             -cos(q(1) + q(2) + q(3) + q(4))/2,                                                                            sin(q(1) + q(2) + q(3) + q(4))/2;
                      - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2 - (5*cos(q(1) + q(2)))/2 - (7*cos(q(1)))/2,                                   - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2 - (5*cos(q(1) + q(2)))/2,                                              - (3*cos(q(1) + q(2) + q(3)))/2 - cos(q(1) + q(2) + q(3) + q(4))/2,                                       -cos(q(1) + q(2) + q(3) + q(4))/2,                                                                                                             4,                                                                                                           0;
                        (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2 + (7*sin(q(1)))/2,                                     (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2,                                                (3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2,                                        sin(q(1) + q(2) + q(3) + q(4))/2,                                                                                                             0,                                                                                                           4];
 
C = [                   - (3*q_dot(2)*sin(q(2) + q(3)))/2 - (3*q_dot(3)*sin(q(2) + q(3)))/2 - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 - (5*q_dot(2)*sin(q(2)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2 - (sin(q(2) + q(3) + q(4))*q_dot(2))/2 - (sin(q(2) + q(3) + q(4))*q_dot(3))/2 - (sin(q(2) + q(3) + q(4))*q_dot(4))/2, - (3*q_dot(1)*sin(q(2) + q(3)))/2 - (3*q_dot(2)*sin(q(2) + q(3)))/2 - (3*q_dot(3)*sin(q(2) + q(3)))/2 - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 - (5*q_dot(1)*sin(q(2)))/2 - (5*q_dot(2)*sin(q(2)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2 - (sin(q(2) + q(3) + q(4))*q_dot(1))/2 - (sin(q(2) + q(3) + q(4))*q_dot(2))/2 - (sin(q(2) + q(3) + q(4))*q_dot(3))/2 - (sin(q(2) + q(3) + q(4))*q_dot(4))/2, - (3*q_dot(1)*sin(q(2) + q(3)))/2 - (3*q_dot(2)*sin(q(2) + q(3)))/2 - (q_dot(1)*sin(q(3) + q(4)))/2 - (3*q_dot(3)*sin(q(2) + q(3)))/2 - (q_dot(2)*sin(q(3) + q(4)))/2 - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 - (3*q_dot(1)*sin(q(3)))/2 - (3*q_dot(2)*sin(q(3)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2 - (sin(q(2) + q(3) + q(4))*q_dot(1))/2 - (sin(q(2) + q(3) + q(4))*q_dot(2))/2 - (sin(q(2) + q(3) + q(4))*q_dot(3))/2 - (sin(q(2) + q(3) + q(4))*q_dot(4))/2, -((sin(q(2) + q(3) + q(4)) + sin(q(3) + q(4)) + sin(q(4)))*(q_dot(1) + q_dot(2) + q_dot(3) + q_dot(4)))/2, 0, 0;
                                                                                                                                          (3*q_dot(1)*sin(q(2) + q(3)))/2 - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 + (5*q_dot(1)*sin(q(2)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2 + (sin(q(2) + q(3) + q(4))*q_dot(1))/2,                                                                                                                                                                                                                                                                                                                         - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2,                                                                                                                                                                                                                                                                   - (q_dot(1)*sin(q(3) + q(4)))/2 - (q_dot(2)*sin(q(3) + q(4)))/2 - (q_dot(3)*sin(q(3) + q(4)))/2 - (q_dot(4)*sin(q(3) + q(4)))/2 - (3*q_dot(1)*sin(q(3)))/2 - (3*q_dot(2)*sin(q(3)))/2 - (3*q_dot(3)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2,                           -((sin(q(3) + q(4)) + sin(q(4)))*(q_dot(1) + q_dot(2) + q_dot(3) + q_dot(4)))/2, 0, 0;
                                                                                                                                          (3*q_dot(1)*sin(q(2) + q(3)))/2 + (q_dot(1)*sin(q(3) + q(4)))/2 + (q_dot(2)*sin(q(3) + q(4)))/2 + (3*q_dot(1)*sin(q(3)))/2 + (3*q_dot(2)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2 + (sin(q(2) + q(3) + q(4))*q_dot(1))/2,                                                                                                                                                                                                                                                                                                (q_dot(1)*sin(q(3) + q(4)))/2 + (q_dot(2)*sin(q(3) + q(4)))/2 + (3*q_dot(1)*sin(q(3)))/2 + (3*q_dot(2)*sin(q(3)))/2 - (q_dot(4)*sin(q(4)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -(q_dot(4)*sin(q(4)))/2,                                                -(sin(q(4))*(q_dot(1) + q_dot(2) + q_dot(3) + q_dot(4)))/2, 0, 0;
                                                                                                                                                                                (q_dot(1)*sin(q(3) + q(4)))/2 + (q_dot(2)*sin(q(3) + q(4)))/2 + (q_dot(1)*sin(q(4)))/2 + (q_dot(2)*sin(q(4)))/2 + (q_dot(3)*sin(q(4)))/2 + (sin(q(2) + q(3) + q(4))*q_dot(1))/2,                                                                                                                                                                                                                                                                                                    (q_dot(1)*sin(q(3) + q(4)))/2 + (q_dot(2)*sin(q(3) + q(4)))/2 + (q_dot(1)*sin(q(4)))/2 + (q_dot(2)*sin(q(4)))/2 + (q_dot(3)*sin(q(4)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                              (sin(q(4))*(q_dot(1) + q_dot(2) + q_dot(3)))/2,                                                                                                         0, 0, 0;
      q_dot(1)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2 + (7*sin(q(1)))/2) + (q_dot(4)*sin(q(1) + q(2) + q(3) + q(4)))/2 + q_dot(3)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2) + q_dot(2)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2),                                                                                                     (q_dot(4)*sin(q(1) + q(2) + q(3) + q(4)))/2 + q_dot(3)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2) + q_dot(1)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2) + q_dot(2)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2 + (5*sin(q(1) + q(2)))/2),                                                                                                                                                                                                                       (q_dot(4)*sin(q(1) + q(2) + q(3) + q(4)))/2 + q_dot(1)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2) + q_dot(2)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2) + q_dot(3)*((3*sin(q(1) + q(2) + q(3)))/2 + sin(q(1) + q(2) + q(3) + q(4))/2),                            (sin(q(1) + q(2) + q(3) + q(4))*(q_dot(1) + q_dot(2) + q_dot(3) + q_dot(4)))/2, 0, 0];
      
G = [ - (2943*sin(q(1) + q(2) + q(3)))/200 - (981*sin(q(1) + q(2) + q(3) + q(4)))/200 - (2943*sin(q(1) + q(2)))/200 - (2943*sin(q(1)))/200;
                             - (2943*sin(q(1) + q(2) + q(3)))/200 - (981*sin(q(1) + q(2) + q(3) + q(4)))/200 - (2943*sin(q(1) + q(2)))/200;
                                                           - (2943*sin(q(1) + q(2) + q(3)))/200 - (981*sin(q(1) + q(2) + q(3) + q(4)))/200;
                                                                                                 -(981*sin(q(1) + q(2) + q(3) + q(4)))/200;
                                                                                                                                         0;
                                                                                                                                    981/25];                             

elseif length(q) == 4
    
   D = [                    cos(q(2)) + 833/500, cos(q(2))/2 + 333/1000, - cos(q(1) + q(2))/2 - (3*cos(q(1)))/2, sin(q(1) + q(2))/2 + (3*sin(q(1)))/2;
                         cos(q(2))/2 + 333/1000,               333/1000,                    -cos(q(1) + q(2))/2,                   sin(q(1) + q(2))/2;
         - cos(q(1) + q(2))/2 - (3*cos(q(1)))/2,    -cos(q(1) + q(2))/2,                                      2,                                    0;
           sin(q(1) + q(2))/2 + (3*sin(q(1)))/2,     sin(q(1) + q(2))/2,                                      0,                                    2];
       
 C = [                                                         -(q_dot(2)*sin(q(2)))/2,       -(sin(q(2))*(q_dot(1) + q_dot(2)))/2, 0, 0;
                                                                (q_dot(1)*sin(q(2)))/2,                                          0, 0, 0;
       (q_dot(2)*sin(q(1) + q(2)))/2 + q_dot(1)*(sin(q(1) + q(2))/2 + (3*sin(q(1)))/2), (sin(q(1) + q(2))*(q_dot(1) + q_dot(2)))/2, 0, 0;
       q_dot(1)*(cos(q(1) + q(2))/2 + (3*cos(q(1)))/2) + (q_dot(2)*cos(q(1) + q(2)))/2, (cos(q(1) + q(2))*(q_dot(1) + q_dot(2)))/2, 0, 0];
 
G =  [ - (981*sin(q(1) + q(2)))/200 - (2943*sin(q(1)))/200
                               -(981*sin(q(1) + q(2)))/200
                                                         0
                                                    981/50];

elseif length(q) == 3
    
D = [     333/1000, -cos(q(1))/2, sin(q(1))/2;
      -cos(q(1))/2,            1,           0;
       sin(q(1))/2,            0,           1];
          
          
C = [                      0, 0, 0;
      (q_dot(1)*sin(q(1)))/2, 0, 0;
      (q_dot(1)*cos(q(1)))/2, 0, 0];
 
      
G = [ -(981*sin(q(1)))/200;
                         0;
                  981/100];
end
 
end